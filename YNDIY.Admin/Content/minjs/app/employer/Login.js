require.config({baseUrl:"/Content/js",paths:{jquery:"jquery-1.7.2",domReady:"domReady"}}),require(["jquery","domReady"],function(a){function b(){a("._loading").hide()}function c(){a("._loading").show()}function d(){c(),a.ajax({type:"get",url:"/Login/GetCode",dataType:"html",success:function(c){b(),a("._code_pic").html(c)},erro:function(a){b(),alert("网络故障")}})}function e(){var b=a("input[name='account']").val();return!!/^.{4,16}$/.test(b)||(a("input[name='account']").val("请输入用户帐号,长度不小于4个字符").addClass("_error"),!1)}function f(){var b=a("input[name='password']").val();return!!/^[\s\S]{5,16}$/.test(b)||(a("input[name='password']").prop("type","text").val("请输入密码,长度5-20个字符").addClass("_error"),!1)}function g(){var b=a("input[name='_mvcCaptchaText']").val();return!!/^[a-zA-Z0-9]{4}$/.test(b)||(a("input[name='_mvcCaptchaText']").val("请输入验证码,长度为4个字符").addClass("_error"),!1)}function h(){var b=i("user_info");null!==b&&(b=b.split("^"),a("input[name='account']").val(b[0]),a("input[name='password']").val(b[1]),a("input[type='checkbox']").attr("checked","checked"))}function i(a){return document.cookie.length>0&&(c_start=document.cookie.indexOf(a+"="),c_start!=-1)?(c_start=c_start+a.length+1,c_end=document.cookie.lastIndexOf("^",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):null}function j(a,b,c,d){var e=new Date;e.setDate(e.getDate()+d),document.cookie=a+"="+escape(b)+"^"+escape(c)+(null==d?"":"^;expires="+e.toGMTString())}function k(){j("user_info",a("input[name='account']").val(),a("input[name='password']").val(),365)}function l(a){document.cookie=a+"=;expires=Thu, 01-Jan-70 00:00:01 GMT"}function m(){e()&&f()&&g()&&(c(),a.ajax({type:"post",url:"/login/WebLogin",data:a("form[name='_login']").serialize(),dataType:"json",success:function(c){if(b(),0===c.code)d(),a("._message").text(c.message).addClass("_error");else{var e=a("input[type='checkbox']:checked").val();1==e?k():l("user_info"),window.location.href=c.redirectUrl}},error:function(c){b(),d(),a("._message").text("系统异常,请重新登录").addClass("_error")}}))}d(),h(),a("form[name=_login]").on("focus",".pwd input",function(){a(this).prop("type","password")}),a("form[name=_login]").on("focus","._error",function(){a(this).val("").removeClass("_error")}),a("form[name=_login]").on("focus","input",function(){a("._error").empty()}),a("form[name=_login]").on("click",'input[type="checkbox"]',function(){var b=a("input[type='checkbox']:checked").val();1!=b&&l("user_info")}),a("._login_btn").on("click",function(){m()}),a(".vali input[name='_mvcCaptchaText']").on("keyup",function(a){13==a.keyCode&&m()})});