require(["/Content/minjs/config.js"],function(){require(["jquery","pop_window","base","utils","domReady"],function(a,b,c,d,b){function e(b){var c=a(".pro_price_tab tbody");c.empty();for(var d=0;d<b.length;d++){var e=a(g);e.children().eq(0).text(b[d].product.produce_name).attr("title",b[d].product.produce_name),e.children().eq(1).text(b[d].product.model_name).attr("title",b[d].product.model_name),e.children().eq(2).text(b[d].product.format).attr("title",b[d].product.format),e.children().eq(3).text(b[d].product.color),e.children().eq(4).text(b[d].product.unit),e.children().eq(5).text(b[d].product.standard_price),e.children().eq(6).children().val(b[d].product.standard_price),null!=b[d].price?e.children().eq(6).children().val(b[d].price.price).attr("_id",b[d].price.id):e.children().eq(6).children().val(b[d].product.standard_price).attr("_id","0"),c.append(e)}}c.init();var f,g=' <tr>                                                                                                                                                                                                                                                                                                                                                                                                                                                               <td class="_td_10 _over_text">产品名称</td>                                                <td class="_td_10 _over_text">产品型号</td>                                                <td class="_td_10 _over_text">产品规格</td>                                                <td>产品颜色</td>                                                <td>单位</td>                                                <td>标准单价（元）</td>                                                <td><input type="text" placeholder="客户单价" class="_input_area" onkeyup="this.value = this.value.replace(/[^0-9^.]/g, \'\')" onafterpaste="this.value = this.value.replace(/[^0-9]/g,\'\')"></td>                                                  </tr>',h=window.location.href.split("=")[1],i=null;a(".pro_price_tab ").on("blur","tbody input",function(){var b={};b.id="undefined"==typeof a(this).attr("_id")?0:a(this).attr("_id"),b.price=parseInt(a(this).parents("tr").eq(0).children().last().children().val()),b.price=b.price?b.price:0;var c=a(this).parents("tr").eq(0).index();i[c].price=b}),a(".brand_tab").on("click",".dele",function(){var b=a(this);a.Message({type:"confirm",content:"你确定删除此产品吗?删除后该产品下面的所有内容将会清除！",okFun:function(){a.when(c.getCodeData({customer_id:h,brand_id:b.attr("_id")},"/ERPBrand/DeleteSomeoneBrandInCustomer")).done(function(){window.location.reload()})}})}),a(".brand_tab").on("click",".edit_price",function(){f=a(this).attr("_id"),a.when(c.getData({customer_id:h,brand_id:f},"/ERPBrand/GetAllPriceByBrandId")).done(function(b){i=b;for(var c=0;c<i.length;c++)delete i[c].product.create_time,delete i[c].product.modify_time,delete i[c].product.package_info,delete i[c].product.parts_info,delete i[c].product.packing_info,delete i[c].product.process_info,delete i[c].product.try_process_info,null!=i[c].price&&(delete i[c].price.create_time,delete i[c].price.modify_time);e(i),a(".pro_price_con").fadeIn()})}),a(".sub_mit").on("click",function(){var b=[];a(".pro_price_tab tbody tr").each(function(c,d){var e=a(d).children().eq(5).text(),f=a(d).children().eq(6).children().val();e!=f&&b.push(i[c])}),a.when(c.getCodeData({brand_id:f,customer_id:h,data:d.json2str(b)},"/ERPBrand/SetPriceInBrand","post")).done(function(){a.Message({type:"alert",content:"编辑成功！"}),a(".pro_price_con").fadeOut()})})})});