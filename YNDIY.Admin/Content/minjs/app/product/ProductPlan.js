require(["/Content/minjs/config.js"],function(){require(["jquery","base","laydate","pop_window","utils","domReady"],function(a,b){b.init(),require(["laydate"],function(){var b={elem:"#start_date",format:"YYYY-MM-DD",max:"2099-06-16 23:59:59",istime:!1,istoday:!1,choose:function(a){c.min=a,c.start=a}},c={elem:"#end_date",format:"YYYY-MM-DD",max:"2099-06-16 23:59:59",istime:!1,istoday:!1,choose:function(a){b.max=a,_load_items(1)}},d={elem:"#jiaohuo_start_date",format:"YYYY-MM-DD",max:"2099-06-16 23:59:59",istime:!1,istoday:!1,choose:function(a){e.min=a,e.start=a}},e={elem:"#jiaohuo_end_date",format:"YYYY-MM-DD",max:"2099-06-16 23:59:59",istime:!1,istoday:!1,choose:function(a){d.max=a,_load_items(1)}},f={elem:"#pop_start",format:"YYYY-MM-DD",max:"2099-06-16 23:59:59",istime:!1,istoday:!1,choose:function(a){c.min=a,c.start=a}},g={elem:"#pop_end",format:"YYYY-MM-DD",max:"2099-06-16 23:59:59",istime:!1,istoday:!1,choose:function(a){b.max=a}};laydate(f),laydate(g),laydate(b),laydate(c),laydate(d),laydate(e),a("#pop_start").val(laydate.now)});var c;window._load_items=function(c){a.when(b.loadHtmlData({lateState:a("#late_state").val(),orderState:a("#order_state").val(),orderStartDate:a("#start_date").val(),orderEndDate:a("#end_date").val(),jiaohuoStartDate:a("#jiaohuo_start_date").val(),jiaohuoEndDate:a("#jiaohuo_end_date").val(),searchKey:a(".search_input").val(),pageIndex:c},"/ERPProduct/GetProductList")).done(function(c){a("._ajax_container").empty().append(c),b.repainWindow()})},_load_items(1),a("._ajax_container").on("click",".edit_paln",function(){a(".plan_con").fadeIn(),c=a(this).attr("_id")}),a("._opacity_select").on("change",function(){_load_items(1)}),a(".plan_con").on("click",".sub_mit",function(){var b=parseInt(a(".plan_con input").eq(0).val());if(!b)return void a.Message({type:"alert",content:"请输入本次出库数量！"});var d=a(".plan_con input").eq(1).val();if(!d)return void a.Message({type:"alert",content:"请选择出库日期！"});var e=a(".plan_con input").eq(2).val();_show_loading(),a.ajax({type:"get",url:"/ERPFinance/Recharge",data:{order_id:c,num:b,date:d,tip:e},success:function(b){_hide_loading(),1==b.code?(a.Message({type:"alert",content:"提交成功！"}),a(".plan_con").fadeOut(),_load_items(1)):a.Message({type:"alert",content:b.message})},error:function(){_hide_loading(),a.Message({type:"alert",content:"网络异常,请刷新重试！"})}})}),a("._ajax_container").on("click",".dele",function(){var c=a(this),d=c.parents("tr").first().children().eq(0).text();a.Message({type:"confirm",content:"确定删除 "+d+"生产计划吗？删除后数据不可恢复，请慎重！",okFun:function(){a.when(b.getCodeData({id:c.attr("_id")},"/ERPBrand/DeleteProduct")).done(function(){a.Message({type:"alert",content:"删除成功！"}),_load_items(1)})}})})})});