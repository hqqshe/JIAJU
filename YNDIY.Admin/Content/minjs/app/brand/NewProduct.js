require(["/Content/minjs/config.js"],function(){require(["jquery","pop_window","base","uploadForm","domReady"],function(a,b,c,b,b){function d(){var b={};return b.image=a(".img_view img").attr("src"),b.brandId=a("#brand_select").val(),b.unit=a("._search_filter .unit_select").val(),a("._input_panel input").each(function(c,d){0==c?b.model=a(d).val():1==c?b.name=a(d).val():2==c?b.format=a(d).val():3==c?b.color=a(d).val():4==c?b.price=a(d).val():5==c?b.lowerLine=a(d).val():6==c?b.remark=a(d).val():null}),b}function e(b){return""==b.model?(a.Message({type:"alert",content:"产品型号不能为空！"}),!0):""==b.name?(a.Message({type:"alert",content:"产品名称不能为空！"}),!0):""==b.format?(a.Message({type:"alert",content:"产品规格不能为空！"}),!0):""==b.color?(a.Message({type:"alert",content:"产品颜色不能为空！"}),!0):""==b.price?(a.Message({type:"alert",content:"产品标准单价不能为空！"}),!0):""==b.lowerLine&&(a.Message({type:"alert",content:"库存下限不能为空！"}),!0)}c.init();var f=null,g=window.location.href.split("=")[1];a(".upload_img").on("click",function(){f=a(this).prev().find("img")}).uploadForm({success:function(b){/.png$/.test(b)?f.attr("src",b).show():"sizelimit"==b?(alert("图片过大！"),a.Message({type:"alert",content:response.message})):(alert("上传失败！"),a.Message({type:"alert",content:response.message}))}}),a(".sub_mit").on("click",function(){var b=d();e(b)||(b.id=g?g:null,g?a.when(c.getCodeData(b,"/ERPBrand/SaveEditProduct")).done(function(){window.location.href="/ERPBrand/ProductList"}):a.when(c.getCodeData(b,"/ERPBrand/AddProduct")).done(function(){window.location.href="/ERPBrand/ProductList"}))})})});